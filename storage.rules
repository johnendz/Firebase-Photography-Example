service firebase.storage {
    match /b/{bucket}/o {
        match /{userId}/{fileName}{
          allow read;
          allow write: if request.auth.uid == userId && request.resource.size < 2 * 1024 * 1024
                    && request.resource.contentType.matches('image/.*')
                    && (resource == null || request.resource.contentType == resource.contentType);
        }
    }
}
